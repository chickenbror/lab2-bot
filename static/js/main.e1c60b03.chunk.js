(this["webpackJsonpxstate-react-typescript-template"]=this["webpackJsonpxstate-react-typescript-template"]||[]).push([[0],{22:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return parse}));var _srgs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(8);function LOG(e){}function clone(e){if(null==e||"object"!=typeof e)return e;var t=new e.constructor;for(var n in e)t[n]=clone(e[n]);return t}function isEmpty(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function Chart(e){this.numberOfWords=e,this.passives=new Array(e),this.actives=new Array(e);for(var t=0;t<=e;t++)this.passives[t]={},this.actives[t]={};this.add=function(e){var t,n;return e.isPassive?(t=this.passives[e.start],n=e.lhs):(t=this.actives[e.end],n=e.next.content),n in t||(t[n]={}),!(e in t[n])&&(t[n][e]=e,!0)},this.resultsForRule=function(t,n,i){n=n||0,i=i||e;var r=[],s=this.passives[n][t];for(var a in s)s[a].end==i&&r.push(s[a].out);return r},this.allEdges=function(){return this.allPassiveEdges().concat(this.allActiveEdges())},this.allPassiveEdges=function(){var e=[];for(var t in this.passives)for(var n in this.passives[t])for(var i in this.passives[t][n])e.push(this.passives[t][n][i]);return e},this.allActiveEdges=function(){var e=[];for(var t in this.actives)for(var n in this.actives[t])for(var i in this.actives[t][n])e.push(this.actives[t][n][i]);return e},this.statistics=function(){var e=this.allPassiveEdges().length,t=this.allActiveEdges().length;return{nrEdges:e+t,nrPassiveEdges:e,nrActiveEdges:t}}}function PassiveEdge(e,t,n,i){this.start=e,this.end=t,this.lhs=n,this.out=i,this.isPassive=!0;var r="["+e+"-"+t+"] $"+n+" := "+i;this._string=r,this.toString=function(){return this._string}}function ActiveEdge(e,t,n,i,r,s,a,o){this.start=e,this.end=t,this.lhs=n,this.next=i,this.rest=r,this.out=s,this.rules=a,this.text=o,this.isPassive=!1;var c="<"+e+"-"+t+"> $"+n+" -> "+i+", "+r+" := "+s+" <- "+a;this._string=c,this.toString=function(){return this._string}}function parse(words,grammar,root,filter){root||(root=grammar.$root);var chart=new Chart(words.length),agenda=[],leftCornerFilter;function addToChart(inference,start,end,lhs,rhs,out,rules,text){var edge;if(rhs.length>0){var next=rhs[0],rest=rhs.slice(1);switch(next.constructor){case Array:return void addToChart(inference+",SEQUENCE",start,end,lhs,next.concat(rest),out,rules,text);case _srgs__WEBPACK_IMPORTED_MODULE_0__.g:var min=next.min,max=next.max;if(min<=0&&addToChart(inference+",SKIP",start,end,lhs,rest,out,rules,text),max>0){var content=next.content,rhs=1==max?[content]:[content,_srgs__WEBPACK_IMPORTED_MODULE_0__.f(min?min-1:min,max-1,content)];addToChart(inference+",REPEAT",start,end,lhs,rhs.concat(rest),out,rules,text)}return;case _srgs__WEBPACK_IMPORTED_MODULE_0__.c:var oneof=next.content;for(var i in oneof){var rhs=oneof[i].concat(rest);addToChart(inference+",ONEOF",start,end,lhs,rhs,out,rules,text)}return;case _srgs__WEBPACK_IMPORTED_MODULE_0__.i:return out=clone(out),rules=clone(rules),eval(next.content),void addToChart(inference+",TAG",start,end,lhs,rest,out,rules,text)}edge=new ActiveEdge(start,end,lhs,next,rest,out,rules,text)}else edge=new PassiveEdge(start,end,lhs,out);chart.add(edge)&&(LOG("+ "+inference+": "+edge),agenda.push(edge))}for(leftCornerFilter=void 0==filter?function(){return!0}:function(e,t){var n=filter[e];return!n||words[t]in n},addToChart("INIT",0,0,root,grammar[root],{},{},{});agenda.length>0;){var edge=agenda.pop(),start=edge.start,end=edge.end,lhs=edge.lhs,next=edge.next;if(LOG(edge),edge.isPassive){var actives=chart.actives[start][lhs];for(var i in actives){var active=actives[i],rules=clone(active.rules),text=active.text;text[edge.lhs]=words.slice(start,end).join(" "),"object"==typeof edge.out&&isEmpty(edge.out)?rules[edge.lhs]=text[edge.lhs]:rules[edge.lhs]=clone(edge.out),addToChart("COMBINE",active.start,end,active.lhs,active.rest,active.out,rules,text)}}else if(next.constructor==_srgs__WEBPACK_IMPORTED_MODULE_0__.e){var ref=next.content,passives=chart.passives[end][ref];for(var i in passives){var passive=passives[i],rules=clone(edge.rules),text=edge.text;rules[passive.lhs]=clone(passive.out),text[passive.lhs]=passive.text,addToChart("COMBINE",start,passive.end,lhs,edge.rest,edge.out,rules,text)}ref in grammar&&leftCornerFilter(ref,end)&&addToChart("PREDICT",end,end,ref,grammar[ref],{},{},{})}else next==words[end]&&addToChart("SCAN",start,end+1,lhs,edge.rest,edge.out,edge.rules,edge.text)}return chart}},26:function(e,t,n){},37:function(e,t,n){"use strict";n.r(t);var i=n(25),r=n(10),s=(n(26),n(7),n(21)),a=n(43),o=n(4),c=n(42),u=n(41),m=n(8);function l(e){for(var t=e.childNodes,n=[],i=0;i<t.length;i++)if(3==t[i].nodeType){var r=t[i].textContent.trim();""!=r&&n.push(r.split(/ +/))}else if(1==t[i].nodeType)if("token"==t[i].nodeName)n.push(m.h(t[i].textContent));else if("ruleref"==t[i].nodeName){var s=t[i].getAttribute("uri");n.push(m.d(s.slice(1)))}else if("tag"==t[i].nodeName)n.push(m.h(t[i].textContent.trim()));else if("one-of"==t[i].nodeName)n.push(m.b(l(t[i])));else if("item"==t[i].nodeName){var a=t[i].getAttribute("repeat");if(a){var o=a.split("-"),c=parseInt(o[0]),u=parseInt(o[1]);u=u||1/0,n.push(m.f(c,u,l(t[i])))}else n.push(l(t[i]))}else console.log(t[i]);return n}var d=n(22);const h=function(e){for(var t=function(e){if("undefined"!=typeof DOMParser)return(new DOMParser).parseFromString(e,"application/xml");if("undefined"!=typeof ActiveXObject){var t=XML.newDocument();return t.loadXML(e),t}var n="data:text/xml;charset=utf-8,"+encodeURIComponent(e),i=new XMLHttpRequest;return i.open("GET",n,!1),i.send(null),i.responseXML}(e),n=t.getElementsByTagName("grammar")[0].getAttribute("root"),i=new m.a(n),r=t.getElementsByTagName("rule"),s=0;s<r.length;s++){var a=r[s];i[a.getAttribute("id")]=l(a)}return i}('\n<grammar root="mymeeting">\n  <rule id="mymeeting">\n    \n    <item repeat="0-"><ruleref uri="#Politeness"/></item>\n\t\n    <item repeat="0-1"><ruleref uri="#MakeMeeting"/></item>\n\n    \x3c!--Six different orders--\x3e\n    <one-of>  \n        <item> <item repeat="0-1"><ruleref uri="#person"/></item><item repeat="0-1"><ruleref uri="#day"/></item><item repeat="0-1"><ruleref uri="#time"/></item> </item>\n        <item> <item repeat="0-1"><ruleref uri="#person"/></item><item repeat="0-1"><ruleref uri="#time"/></item><item repeat="0-1"><ruleref uri="#day"/></item> </item> \n        <item> <item repeat="0-1"><ruleref uri="#day"/></item><item repeat="0-1"><ruleref uri="#person"/></item><item repeat="0-1"><ruleref uri="#time"/></item> </item>\n        <item> <item repeat="0-1"><ruleref uri="#day"/></item><item repeat="0-1"><ruleref uri="#time"/></item><item repeat="0-1"><ruleref uri="#person"/></item> </item>\n        <item> <item repeat="0-1"><ruleref uri="#time"/></item><item repeat="0-1"><ruleref uri="#day"/></item><item repeat="0-1"><ruleref uri="#person"/></item> </item>\n        <item> <item repeat="0-1"><ruleref uri="#time"/></item><item repeat="0-1"><ruleref uri="#person"/></item><item repeat="0-1"><ruleref uri="#day"/></item> </item>   \n    </one-of>\n    \n    <item repeat="0-"><ruleref uri="#Politeness"/></item>\n    <item repeat="0-">.</item><item repeat="0-">!</item><item repeat="0-">?</item>\n    \n    <tag>\n     out.meeting=new Object();\n     out.meeting.person= rules.person; \n     out.meeting.day= rules.day; \n     out.meeting.time= rules.time; \n    </tag>\n    \n  </rule> \n\n   //Polite Expressions//\n   <rule id="Politeness">\n        <one-of>  \n            <item> please </item> <item> thanks </item> <item> thank you </item> \n\t\t\t<item> could you </item> <item> would you </item> <item> can you </item> \n\t\t\t<item> will you </item> <item> i would like to </item> \n        </one-of>\n   </rule>\n\n  \n   //Make Meeting Command//\n   <rule id="MakeMeeting">\n        <one-of>  \n            <item> create a meeting </item> <item> create an appointment </item> \n\t\t\t<item> make a meeting </item> <item> make an appointment </item>\n            <item> we have a meeting </item> <item> have a meeting </item>\n            <item> i am meeting </item> <item> i\'m meeting </item> <item> meet </item> <item> i have a meeting </item>\n            <item> meeting </item> \n        </one-of>\n   </rule>\n\n   //People//\n   <rule id="person"> <item repeat="0-1">with</item>\n        <one-of>  \n            \n            <item> john <tag> out="John Appleseed" </tag></item>  \n            <item> goofy <tag> out="Goofy Dog" </tag></item> \n            <item> mickey <tag> out="Mickey Mouse" </tag></item> \n            <item> minnie <tag> out="Minnie Mouse" </tag></item> \n            <item> donald <tag> out="Donald Duck" </tag></item> \n            <item> daisy <tag> out="Daisy Duck" </tag></item> \n            <item> lisa <tag> out="Lisa Simpson" </tag></item> \n            <item> homer <tag> out="Homer Simpson" </tag></item> \n            <item> monty <tag> out="Montgomery Burns" </tag></item> \n            <item> apu <tag> out="Apu Nahasapeemapetilon" </tag></item> \n\n        </one-of>\n   </rule>\n   \n   //Days//\n    <rule id="day"> <item repeat="0-1">on</item>\n        <one-of> \n            <item> monday </item> <item> tuesday </item> <item> wednesday </item>\n            <item> thursday </item> <item> friday </item> <item> saturday </item>\n            <item> sunday </item>\n        </one-of> \n    </rule>\n\n   //Times//\n    <rule id="time"> \n        <one-of> \n            <item>\n                <item repeat="0-1">at</item>\n                <one-of> \n                    <item> noon <tag>out="12 p.m.";</tag></item> \n                    <item> midnight <tag>out="12 a.m.";</tag></item> \n                    <item>1</item> <item>2</item> <item>3</item> <item>4</item> <item>5</item>\n                    <item>6</item> <item>7</item> <item>8</item> <item>9</item> <item>10</item>\n                    <item>11</item> <item>12</item>\n                </one-of>\n\n                <item repeat="0-1">\n                  <one-of> \n                    <item> a.m. </item> <item> p.m. </item>\n                  </one-of>\n                </item>\n            </item>\n\n            <item> <tag> out=\'whole day\'; </tag>\n                <item repeat="0-1">for</item>\n                <item repeat="0-1">the</item>\n                <one-of>\n                <item> whole day </item> <item> all day </item> <item> entire day </item>\n                </one-of>\n            </item>\n\n        </one-of>\n\n    </rule>\n   \n</grammar>\n');function g(e){let t,n=Object(d.a)(e.toLowerCase().split(/\s+/),h).resultsForRule(h.$root)[0];return void 0!=n&&(t=n.meeting,t.time&&"at "===t.time.slice(0,3)&&(t.time=t.time.slice(3)),t.day&&"on "===t.day.slice(0,3)&&(t.day=t.day.slice(3))),t}function p(e){let t,n=[];return e.person||n.push("with whom"),e.weekday||n.push("on which day"),e.time||n.push("at what time"),0===n.length&&(t="I have all the details of your meeting!"),1===n.length&&(t="Tell me ".concat(n[0]," you are meeting")),2===n.length&&(t="Tell me ".concat(n[0],", and ").concat(n[1]," is your meeting")),3===n.length&&(t="Tell me ".concat(n[0],", ").concat(n[1],", and ").concat(n[2]," is the meeting")),t}function f(e){let t,n=e.person?"with "+e.person:"",i=e.weekday?"on "+e.weekday:"";return t=e.time?"whole day"===e.time?"for the whole day":"at "+e.time:"","".concat(n," ").concat(i," ").concat(t)}function v(e){return Object(o.k)((t=>({type:"SPEAK",value:e})))}function y(e){return{initial:"prompt",states:{prompt:{entry:e,on:{ENDSPEECH:"ask"}},ask:{entry:Object(o.k)("LISTEN")},nomatch:{entry:[v("Sorry, I didnt get that")],on:{ENDSPEECH:"prompt"}}}}}const E={initial:"init",states:{init:{on:{CLICK:"start"}},stop:{entry:v("Ok, stopped"),always:"init"},start:{entry:v("Lets make an appointment. "),on:{ENDSPEECH:"welcome"}},restart:{entry:v("Ok, starting over"),on:{ENDSPEECH:"welcome"}},welcome:Object(r.a)({on:{RECOGNISED:[{cond:e=>!!g(e.recResult),actions:Object(o.b)((e=>({person:g(e.recResult).person,weekday:g(e.recResult).day,time:g(e.recResult).time}))),target:"transit"},{target:"stop",cond:e=>"stop"===e.recResult},{target:"restart",cond:e=>"restart"===e.recResult},{target:".nomatch"}]}},y(v("Tell me the meeting details."))),transit:{always:[{target:"final",cond:e=>!!e.person&&!!e.weekday&&!!e.time},{target:"askMore",cond:e=>!e.person||!e.weekday||!e.time}]},askMore:Object(r.a)({on:{RECOGNISED:[{cond:e=>!!g(e.recResult)&&!!e.weekday&&!!e.time,actions:Object(o.b)((e=>({person:g(e.recResult).person}))),target:"transit"},{cond:e=>!!g(e.recResult)&&!!e.person&&!!e.time,actions:Object(o.b)((e=>({weekday:g(e.recResult).day}))),target:"transit"},{cond:e=>!!g(e.recResult)&&!!e.person&&!!e.weekday,actions:Object(o.b)((e=>({time:g(e.recResult).time}))),target:"transit"},{cond:e=>!!g(e.recResult)&&!e.person&&!e.weekday,actions:Object(o.b)((e=>({person:g(e.recResult).person,weekday:g(e.recResult).day}))),target:"transit"},{cond:e=>!!g(e.recResult)&&!e.person&&!e.time,actions:Object(o.b)((e=>({person:g(e.recResult).person,time:g(e.recResult).time}))),target:"transit"},{cond:e=>!!g(e.recResult)&&!e.weekday&&!e.time,actions:Object(o.b)((e=>({weekday:g(e.recResult).day,time:g(e.recResult).time}))),target:"transit"},{target:"stop",cond:e=>"stop"===e.recResult},{target:"restart",cond:e=>"restart"===e.recResult},{target:".nomatch"}]}},y(Object(o.k)((e=>({type:"SPEAK",value:p(e)+f(e)+"?"}))))),final:Object(r.a)({on:{RECOGNISED:[{cond:e=>!0===function(e){if(["yes","of course","sure","absolutely","yeah","yep","okay"].includes(e))return!0}(e.recResult),target:"done"},{cond:e=>!0===function(e){if(["no","nope","no thanks","nah"].includes(e))return!0}(e.recResult),target:"restart"},{target:"stop",cond:e=>"stop"===e.recResult},{target:"restart",cond:e=>"restart"===e.recResult},{target:".nomatch"}]}},y(Object(o.k)((e=>({type:"SPEAK",value:"Meeting ".concat(f(e),". Was that correct?")}))))),done:{entry:v("Great, your appointment has been made."),on:{ENDSPEECH:"init"}}}};var _=n(20),x=n(13);Object(u.a)({url:"https://statecharts.io/inspect",iframe:!1});const b=Object(a.a)({id:"root",type:"parallel",states:{dm:Object(r.a)({},E),asrtts:{initial:"idle",states:{idle:{on:{LISTEN:"recognising",SPEAK:{target:"speaking",actions:Object(o.b)(((e,t)=>({ttsAgenda:t.value})))}}},recognising:{initial:"progress",entry:"recStart",exit:"recStop",on:{ASRRESULT:{actions:["recLogResult",Object(o.b)(((e,t)=>({recResult:t.value})))],target:".match"},RECOGNISED:"idle"},states:{progress:{},match:{entry:Object(o.k)("RECOGNISED")}}},speaking:{entry:"ttsStart",on:{ENDSPEECH:"idle"}}}}}},{actions:{recLogResult:e=>{console.log("<< ASR: "+e.recResult)},test:()=>{console.log("test")},logIntent:e=>{console.log("<< NLU intent: "+e.nluData.intent.name)}}}),O=e=>{switch(!0){case e.state.matches({asrtts:"recognising"}):return Object(x.jsx)("button",Object(r.a)(Object(r.a)({type:"button",className:"glow-on-hover",style:{animation:"glowing 20s linear"}},e),{},{children:"Listening..."}));case e.state.matches({asrtts:"speaking"}):return Object(x.jsx)("button",Object(r.a)(Object(r.a)({type:"button",className:"glow-on-hover",style:{animation:"bordering 1s infinite"}},e),{},{children:"Speaking..."}));default:return Object(x.jsx)("button",Object(r.a)(Object(r.a)({type:"button",className:"glow-on-hover"},e),{},{children:"Click to start"}))}};function k(){const e=Object(_.useSpeechSynthesis)({onEnd:()=>{l("ENDSPEECH")}}),t=e.speak,n=e.cancel,r=(e.speaking,Object(_.useSpeechRecognition)({onResult:e=>{l({type:"ASRRESULT",value:e})}})),s=r.listen,a=(r.listening,r.stop),o=Object(c.b)(b,{devTools:!0,actions:{recStart:Object(c.a)((()=>{console.log("Ready to receive a voice input."),s({interimResults:!1,continuous:!0})})),recStop:Object(c.a)((()=>{console.log("Recognition stopped."),a()})),ttsStart:Object(c.a)(((e,n)=>{console.log("Speaking..."),t({text:e.ttsAgenda})})),ttsCancel:Object(c.a)(((e,t)=>{console.log("TTS STOP..."),n()})),speak:Object(c.a)((e=>{console.log("Speaking..."),t({text:e.ttsAgenda})}))}}),u=Object(i.a)(o,3),m=u[0],l=u[1];u[2];return Object(x.jsx)("div",{className:"App",children:Object(x.jsx)(O,{state:m,onClick:()=>l("CLICK")})})}const w=document.getElementById("root");s.render(Object(x.jsx)(k,{}),w)},8:function(e,t,n){"use strict";function i(e){this.$root=e,this.VOID=[a([])],this.NULL=[],this.GARBAGE=[],this.$check=function(){for(var e in this)if("$root"!==e&&"$check"!==e)try{h(this[e])}catch(t){d("When checking grammar rule '"+e+"'",t)}}}function r(e){return new c(e)}function s(e){return new u(e)}function a(e){return new m(e)}function o(e,t,n){return new l(e,t,n)}function c(e){this.content=e,this._string="$"+e,this.toString=function(){return this._string}}function u(e){this.content=e,this._string="{"+e+"}",this.toString=function(){return this._string}}function m(e){this.content=e,this._string="("+e.join("|")+")",this.toString=function(){return this._string}}function l(e,t,n){this.min=e,this.max=t,this.content=n,this._string=this.content+"<"+this.min+"-"+(this.max==1/0?"":this.max)+">",this.toString=function(){return this._string}}function d(e,t){throw void 0==t?TypeError(e):TypeError(e+"; "+t.message)}function h(e){try{for(var t in e.constructor!==Array&&d("Expected Array, found "+e.constructor.name),e)e[t].constructor==Array?h(e[t]):e[t].constructor!=String&&e[t].checkExpansion()}catch(n){d("When checking sequence expansion",n)}}n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"h",(function(){return s})),n.d(t,"b",(function(){return a})),n.d(t,"f",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"i",(function(){return u})),n.d(t,"c",(function(){return m})),n.d(t,"g",(function(){return l})),c.prototype.checkExpansion=function(){this.content.constructor!==String&&d("When checking Ref content; Expected String, found "+this.content.constructor.name)},u.prototype.checkExpansion=function(){this.content.constructor!==String&&d("When checking Tag content; Expected String, found "+this.content.constructor.name)},m.prototype.checkExpansion=function(){try{for(var e in this.content.constructor!==Array&&d("Expected Array, found "+this.content.constructor.name),this.content)h(this.content[e])}catch(t){d("When checking OneOf content",t)}},l.prototype.checkExpansion=function(){try{this.min.constructor===Number&&this.max.constructor===Number||d("Expected min/max to be Number, found "+this.min.constructor.name+"/"+this.max.constructor.name),0<=this.min&&this.min<=this.max||d("Expected 0 <= min <= max, found "+this.min+"/"+this.max),h(this.content)}catch(e){d("When checking Repeat content",e)}}}},[[37,1,2]]]);
//# sourceMappingURL=main.e1c60b03.chunk.js.map